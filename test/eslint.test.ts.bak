import { describe, it, expect } from 'vitest'
import { execSync } from 'child_process'

describe('ESLint 检查', () => {
  it('src 目录下所有文件应无 ESLint 错误', () => {
    // 运行 ESLint，输出为 JSON
    const result = execSync('npx eslint src/ --ext .js,.ts,.vue --format json || true').toString()
    const report = JSON.parse(result)
    // 统计所有文件的错误
    let totalErrors = 0
    for (const file of report) {
      totalErrors += file.errorCount
    }
    // 断言无错误
    expect(totalErrors).toBe(0)
  })
})
